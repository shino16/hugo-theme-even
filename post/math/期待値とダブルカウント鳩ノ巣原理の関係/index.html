<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>期待値とダブルカウント・鳩ノ巣原理の関係 - shino16</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="shino16" /><meta name="description" content="深夜の算数クイズ 4 pic.twitter.com/nXIjPTlmoo &amp;mdash; きり (@kiri8128) September 28, 2020 この問題をきっかけに期待値を利用した証明法についていくつか復習し、役割や鳩ノ巣原理との関係などを考えました" />






<meta name="generator" content="Hugo 0.110.0 with theme even" />


<link rel="canonical" href="https://shino16.github.io/blog/post/math/%E6%9C%9F%E5%BE%85%E5%80%A4%E3%81%A8%E3%83%80%E3%83%96%E3%83%AB%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E9%B3%A9%E3%83%8E%E5%B7%A3%E5%8E%9F%E7%90%86%E3%81%AE%E9%96%A2%E4%BF%82/" />
<link rel="apple-touch-icon" sizes="180x180" href="/blog/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png">
<link rel="manifest" href="/blog/manifest.json">
<link rel="mask-icon" href="/blog/safari-pinned-tab.svg" color="#5bbad5">



<link href="/blog/sass/main.min.c9cedc833526a91ee1d9988d16493ed2bb04090270bc9d133d142865cd755421.css" rel="stylesheet">
<link href="/blog/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">
<link rel="stylesheet" href="/blog/css/custom.css">


<meta property="og:title" content="期待値とダブルカウント・鳩ノ巣原理の関係" />
<meta property="og:description" content="深夜の算数クイズ 4 pic.twitter.com/nXIjPTlmoo &mdash; きり (@kiri8128) September 28, 2020 この問題をきっかけに期待値を利用した証明法についていくつか復習し、役割や鳩ノ巣原理との関係などを考えました" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shino16.github.io/blog/post/math/%E6%9C%9F%E5%BE%85%E5%80%A4%E3%81%A8%E3%83%80%E3%83%96%E3%83%AB%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E9%B3%A9%E3%83%8E%E5%B7%A3%E5%8E%9F%E7%90%86%E3%81%AE%E9%96%A2%E4%BF%82/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-10-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-10-01T00:00:00+00:00" />
<meta itemprop="name" content="期待値とダブルカウント・鳩ノ巣原理の関係">
<meta itemprop="description" content="深夜の算数クイズ 4 pic.twitter.com/nXIjPTlmoo &mdash; きり (@kiri8128) September 28, 2020 この問題をきっかけに期待値を利用した証明法についていくつか復習し、役割や鳩ノ巣原理との関係などを考えました"><meta itemprop="datePublished" content="2020-10-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-10-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="1915">
<meta itemprop="keywords" content="数学,Twitter," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="期待値とダブルカウント・鳩ノ巣原理の関係"/>
<meta name="twitter:description" content="深夜の算数クイズ 4 pic.twitter.com/nXIjPTlmoo &mdash; きり (@kiri8128) September 28, 2020 この問題をきっかけに期待値を利用した証明法についていくつか復習し、役割や鳩ノ巣原理との関係などを考えました"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>

</head>
<body onload="onload()">
  <script>
  function onload() {
    document.getElementById("footer-email").setAttribute("href", "mailto:" + "masatosinokawa" + "@" + "gmail.com");
  }
  </script>
  
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/blog/" class="logo">shino16</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/blog/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/blog/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/blog/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/blog/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/blog/" class="logo">shino16</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/blog/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/blog/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/blog/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/blog/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">期待値とダブルカウント・鳩ノ巣原理の関係</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-10-01 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#期待値の線形性">期待値の線形性</a>
          <ul>
            <li></li>
          </ul>
        </li>
        <li><a href="#存在性の証明">存在性の証明</a>
          <ul>
            <li></li>
          </ul>
        </li>
        <li><a href="#最初の問題">最初の問題</a>
          <ul>
            <li></li>
          </ul>
        </li>
        <li><a href="#期待値の意味">期待値の意味</a>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    <div class="post-content">
      <blockquote class="twitter-tweet"><p lang="ja" dir="ltr">深夜の算数クイズ 4 <a href="https://t.co/nXIjPTlmoo">pic.twitter.com/nXIjPTlmoo</a></p>&mdash; きり (@kiri8128) <a href="https://twitter.com/kiri8128/status/1310646464326987776?ref_src=twsrc%5Etfw">September 28, 2020</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>この問題をきっかけに期待値を利用した証明法についていくつか復習し、役割や鳩ノ巣原理との関係などを考えました。参考文献・問題の出典は以下。</p>
<p><a href="https://web.evanchen.cc/textbooks/OTIS-Excerpts.pdf">Evan Chen, Expected Uses of Probability</a></p>
<p><a href="https://web.evanchen.cc/textbooks/OTIS-Excerpts.pdf">Evan Chen, OTIS Excerpts</a></p>
<p>以下、「ランダムに」と言ったときは起こりうる事象がすべて同様に確からしいものとします。</p>
<h2 id="期待値の線形性">期待値の線形性</h2>
<blockquote>
<p>任意の確率変数 $X_1,X_2,\ldots,X_n$ について、次が成り立つ。
$$ E[X_1 + X_2 + \cdots + X_n] = E[X_1] + E[X_2] + \cdots + E[X_n] $$</p>
</blockquote>
<p>$2$ 変数の場合の証明：</p>
<p>$$
\begin{aligned}
E[X+Y] &amp;= \sum_x \sum_y (x+y)P(X=x,Y=y) \\
&amp;= \sum_x \sum_y xP(X=x,Y=y) + \sum_x \sum_y yP(X=x,Y=y) \\
&amp;= \sum_x x P(X=x) + \sum_y y P(Y=y) \\
&amp;= E[X] + E[Y]
\end{aligned}
$$</p>
<p>各確率変数に重みをつけたものも同様に示せます。</p>
<h4 id="問題1">問題1</h4>
<blockquote>
<p>$2020$ 人の子供が輪になって座っている。あるとき同時に全員の子供がランダムに隣のどちらかの子供を選んで肩をたたく。誰からも肩をたたかれなかった子供の人数の期待値を求めよ。</p>
</blockquote>
<h4 id="答え">答え</h4>
<p>各子供について、誰からも肩をたたかれない確率は $1/4$ なので、期待値の線形性より $2020 \cdot 1/4 = 505$。$\Box$</p>
<h4 id="問題2">問題2</h4>
<blockquote>
<p>$n$ 個の実数が与えられる。このうち $1$ 個以上は非ゼロであり、総和は $0$ である。
適当にこれらの数に $a_1,a_2,\ldots,a_n$ をラベル付けし、下の不等式が成り立つようにできることを示せ。
$$ a_1a_2 + a_2a_3 + \ldots + a_{n-1}a_n + a_na_1 &lt; 0 $$</p>
</blockquote>
<h4 id="答え-1">答え</h4>
<p>$a_1,\ldots,a_n$をランダムに割り振ることを考える。</p>
<p>$$ 2\sum_{i &lt; j} a_ia_j = (a_1 + \cdots + a_n)^2 - (a_1^2 + \cdots + a_n^2) = - (a_1^2 + \cdots + a_n^2) &lt; 0 $$</p>
<p>ゆえに、対称性より</p>
<p>$$ E[a_1a_2] = E[a_2a_3] = \cdots = E[a_na_1] &lt; 0 $$</p>
<p>$$ E[a_1a_2 + a_2a_3 + \cdots + a_na_1] &lt; 0 $$</p>
<p>これより題意を満たす $a_1,\ldots,a_n$ のラベル付けが存在することが示された。$\Box$</p>
<p><a href="http://www.bamo.org/attachments/bamo2004examsol.pdf#page=4">公式解答</a>に比べて、期待値を利用した議論の見やすさが分かる気がする？</p>
<h2 id="存在性の証明">存在性の証明</h2>
<h4 id="問題3">問題3</h4>
<blockquote>
<p>完全二部グラフ$K_{n,n}$から $n-1$ 本の辺を削除する。（$n^2-n+1$ 本の辺が残される。）
辺を削除後のグラフに完全マッチングが必ず存在することを示せ。</p>
</blockquote>
<h4 id="答え-2">答え</h4>
<p>片方の独立集合の頂点を、もう片方にランダムに割り振って $n$ 個の頂点対を作ることを考える。</p>
<p>これらの対を（順番を無視したいので）ランダムに順序づけ、$i=1,\ldots,n$ について確率変数 $X_i$ を</p>
<ul>
<li>$i$ 番目の頂点対が辺でつながれているとき $1$</li>
<li>そうでないとき $0$</li>
</ul>
<p>とし、$X = X_1 + X_2 + \cdots + X_n$ とする。</p>
<p>各 $i$ について $E[X_i] = \dfrac{n^2-n+1}{n^2}$ より、</p>
<p>$$
\begin{aligned}
E[X] &amp;= E[X_1] + E[X_2] + \cdots + E[X_n] \\
&amp;= n \cdot \frac{n^2-n+1}{n^2} \\
&amp;= n - 1 + \frac{1}{n} \\
&amp;&gt; n - 1
\end{aligned}
$$</p>
<p>$X$ は整数の値しかとらないので、$X=n$ を達成する構図が存在することが示された。$\Box$</p>
<h4 id="問題4">問題4</h4>
<blockquote>
<p>ある数学の大会には、6 問の問題と 200 人の参加者がいます。各問題が 120 人以上に解かれたとするとき、どの問題も少なくともどちらかが解いているような 2 人組が存在することを示しなさい。</p>
</blockquote>
<h4 id="答え-3">答え</h4>
<p>ランダムに $2$ 人の参加者を選ぶ。ある問題について $2$ 人とも解いていない確率は高々 $(80/200)^2 = 4/25$。</p>
<p>$6$ 問中で $2$ 人とも解いていない問題数の期待値は高々 $6 \cdot 4/25 &lt; 1$ より、すべての問題を解いた $2$ 人組は存在する。$\Box$</p>
<h2 id="最初の問題">最初の問題</h2>
<blockquote>
<p>平面上に $10$ 個の点がある。
あなたは半径 $1$ の円をいくつか重ならないように平面上に描くことによって、$10$ この点すべてが円の内側に入るようにしたい。</p>
<p>これは必ずできるか。できる場合はその証明を、できない場合は反例（$10$ 点の初期配置）を与えよ。</p>
</blockquote>
<h4 id="答え-4">答え</h4>
<p>円の最密充填は密度 $90.69%$ なので、平面上の10個の点に対してランダムに円の最密充填を配置すると、円の内部にある点の個数の期待値は $0.9069 \cdot 10 = 9.069 &gt; 9$。</p>
<p>これはある互いに重ならない円の配置が存在して、$10$ 個すべての点が円の内部にあることを示している。$\Box$</p>
<h2 id="期待値の意味">期待値の意味</h2>
<p>期待値を持ち出すこと自体に本質的なはたらきはなくて、（この程度の問題を扱う範囲では）由来を考えれば単なる言い方の違いにすぎないのかなと思います。</p>
<p>例えば問題2の<a href="http://www.bamo.org/attachments/bamo2004examsol.pdf#page=4">公式解答</a>は期待値を使った解答と本質的に同じようですし、問題3についても</p>
<h4 id="問題3の答え-2">問題3の答え (2)</h4>
<p>片方の独立集合の頂点をもう片方に割り振ってできる $n$ 個の頂点対の集合は $n!$ 通りある。</p>
<p>ある辺 $(u, v)$ について、対 $(u, v)$ は $n!$ 個の頂点対集合のうち $(n-1)!$ 個に属する。</p>
<p>辺は $n^2 - n + 1$ 本あることから、辺でつながれた頂点対は $n!$ 個の集合の中に $(n^2-n+1)(n-1)!$回現れる。</p>
<p>$$ (n^2-n+1)(n-1)! = \left(n-1+\frac{1}{n}\right)n! &gt; (n-1)n! $$</p>
<p>より、$n!$ 個の頂点対集合のうち $1$ つ以上に $n$ 個の辺でつながれた頂点対が属する。これが求める完全マッチングである。$\Box$</p>
<p>問題4・5も適当に全体集合をとり、各確率変数がとっていた値を独立に足し上げることで言い換えることができそうです。</p>
<p>期待値の線形性はダブルカウントに対応し、「$E[X] &gt; n-1$ より～」の議論は鳩ノ巣原理に対応します。</p>
<p>全体集合の各元を考える代わりに一様ランダムをイメージするのは楽な気がしますし、問題5のように連続の場合が考えやすくなっていそうです。考えることが減って嬉しそうです。</p>

    </div>

    <footer class="post-footer">
      <div class="post-tags">
          <a href="/blog/tags/%E6%95%B0%E5%AD%A6/">数学</a>
          <a href="/blog/tags/twitter/">Twitter</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/blog/post/algo/%E3%82%AA%E3%83%BC%E3%83%88%E3%83%9E%E3%83%88%E3%83%B3/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">オートマトン（DFA）での桁DPを理解する</span>
            <span class="prev-text nav-mobile">前の記事へ</span>
          </a>
        
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="http://twitter.com/shino16_cp" id="footer-twitter" class="iconfont icon-twitter" title="twitter"></a>
      <a href="http://github.com/shino16" id="footer-github" class="iconfont icon-github" title="github"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2020 - 
    2023<span class="heart"><i class="iconfont icon-pencil"></i></span><span>shino16</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/blog/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/blog/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/blog/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/blog/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
